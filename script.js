// Language translations
const translations = {
  de: {
      "nav.features": "Funktionen",
      "nav.pricing": "Preise",
      "nav.testimonials": "Erfahrungsberichte",
      "nav.faq": "FAQ",
      "nav.contact": "Kontakt",
      "hero.title": "Terminierte Produktvarianten für Ihren Shopify-Shop",
      "hero.subtitle": "Planen Sie die Veröffentlichung von Produktvarianten und schaffen Sie Vorfreude bei Ihren Kunden.",
      "hero.cta": "Jetzt installieren",
      "hero.learn": "Mehr erfahren",
      "features.title": "Funktionen",
      "features.subtitle": "Entdecken Sie, wie Variant Release Date Scheduler Ihren Shop verbessert",
      "features.feature1.title": "Geplante Veröffentlichung",
      "features.feature1.desc": "Machen Sie Produktvarianten zu einem bestimmten Zeitpunkt in Ihrem Shop verfügbar und automatisieren Sie Produkteinführungen.",
      "features.feature2.title": "Voransicht vor Veröffentlichung",
      "features.feature2.desc": "Varianten sind bereits im Shop sichtbar, können aber erst nach dem festgelegten Datum gekauft werden.",
      "features.feature3.title": "Schnelle Einrichtung",
      "features.feature3.desc": "In nur 5 Minuten konfiguriert – keine technischen Kenntnisse erforderlich.",
      "features.feature4.title": "Countdown-Timer",
      "features.feature4.desc": "Erzeugen Sie Spannung mit einem Countdown bis zur Veröffentlichung der Variante.",
      "features.feature5.title": "Zeitzonen-Unterstützung",
      "features.feature5.desc": "Planen Sie Veröffentlichungen basierend auf lokalen Zeitzonen Ihrer Kunden.",
      "features.feature6.title": "Interessenmetriken",
      "features.feature6.desc": "Verfolgen Sie, wie viele Kunden sich für kommende Varianten interessieren.",
      "pricing.title": "Preise",
      "pricing.subtitle": "Transparente Preisgestaltung für alle Shop-Größen",
      "pricing.popular": "Beliebt",
      "pricing.basic.title": "Basis",
      "pricing.basic.period": "/Monat",
      "pricing.basic.feature1": "Bis zu 20 geplante Varianten",
      "pricing.basic.feature2": "Grundlegende Countdown-Funktion",
      "pricing.basic.feature3": "E-Mail-Support",
      "pricing.basic.cta": "Jetzt starten",
      "pricing.pro.title": "Pro",
      "pricing.pro.period": "/Monat",
      "pricing.pro.feature1": "Unbegrenzte geplante Varianten",
      "pricing.pro.feature2": "Erweiterte Countdown-Optionen",
      "pricing.pro.feature3": "Prioritäts-Support",
      "pricing.pro.feature4": "Kundeninteresse-Tracking",
      "pricing.pro.feature5": "Anpassbare Benachrichtigungen",
      "pricing.pro.cta": "Pro wählen",
      "pricing.business.title": "Business",
      "pricing.business.period": "/Monat",
      "pricing.business.feature1": "Alles aus Pro",
      "pricing.business.feature2": "Multistore-Unterstützung",
      "pricing.business.feature3": "API-Zugang",
      "pricing.business.feature4": "Dedizierter Account Manager",
      "pricing.business.feature5": "Erweiterte Analyse-Tools",
      "pricing.business.cta": "Business wählen",
      "testimonials.title": "Erfahrungsberichte",
      "testimonials.subtitle": "Was unsere Kunden über Variant Release Date Scheduler sagen",
      "testimonials.testimonial1.text": "\"Die App hat unseren Produktstart revolutioniert. Wir konnten die Aufmerksamkeit unserer Kunden auf kommende Produkte lenken und den Umsatz am Erscheinungstag um 40% steigern.\"",
      "testimonials.testimonial1.name": "Markus Müller",
      "testimonials.testimonial1.company": "Müller Mode GmbH",
      "testimonials.testimonial2.text": "\"Einfach zu bedienen und unglaublich effektiv. Die Vorschaufunktion für Varianten hat die Vorfreude auf unsere limitierten Editionen enorm gesteigert.\"",
      "testimonials.testimonial2.name": "Laura Klein",
      "testimonials.testimonial2.company": "Trendy Treasures",
      "testimonials.testimonial3.text": "\"Diese App war genau das, was wir für unsere saisonalen Kollektionen brauchten. Die Einrichtung war super einfach und der Support ist erstklassig.\"",
      "testimonials.testimonial3.name": "Thomas Schmidt",
      "testimonials.testimonial3.company": "Outdoor Life",
      "faq.title": "Häufig gestellte Fragen",
      "faq.subtitle": "Antworten auf Ihre Fragen zum Variant Release Date Scheduler",
      "faq.q1": "Wie funktioniert der Variant Release Date Scheduler?",
      "faq.a1": "Die App ermöglicht es Ihnen, ein Datum und eine Uhrzeit festzulegen, an dem Produktvarianten für den Kauf freigeschaltet werden. Die Varianten werden im Shop angezeigt, können jedoch erst nach dem festgelegten Zeitpunkt in den Warenkorb gelegt werden.",
      "faq.q2": "Ist die Installation kompliziert?",
      "faq.a2": "Nein, die Installation und Konfiguration dauert nur etwa 5 Minuten. Nach der Installation aus dem Shopify App Store müssen Sie lediglich die Produkte auswählen und die Freigabezeiten für die Varianten festlegen.",
      "faq.q3": "Wie werden die Kunden über neue Varianten informiert?",
      "faq.a3": "Die App zeigt einen Countdown auf der Produktseite an. Zudem können Kunden sich für Benachrichtigungen anmelden, um per E-Mail informiert zu werden, sobald die Variante verfügbar ist.",
      "faq.q4": "Mit welchen Shopify-Themes ist die App kompatibel?",
      "faq.a4": "Unsere App ist mit allen aktuellen Shopify-Themes kompatibel. Bei älteren oder stark angepassten Themes kann eine zusätzliche Anpassung erforderlich sein, für die unser Support-Team Ihnen gerne zur Verfügung steht.",
      "faq.q5": "Gibt es eine kostenlose Testphase?",
      "faq.a5": "Ja, Sie können die App 14 Tage lang kostenlos testen, bevor Sie sich für ein Abonnement entscheiden. Während der Testphase stehen Ihnen alle Funktionen des Pro-Pakets zur Verfügung.",
      "contact.title": "Kontakt",
      "contact.subtitle": "Haben Sie Fragen? Kontaktieren Sie uns!",
      "contact.email": "E-Mail",
      "contact.phone": "Telefon",
      "contact.hours": "Geschäftszeiten",
      "contact.hours_detail": "Mo-Fr: 9:00 - 17:00 Uhr",
      "contact.form.name": "Name",
      "contact.form.email": "E-Mail",
      "contact.form.subject": "Betreff",
      "contact.form.message": "Nachricht",
      "contact.form.submit": "Nachricht senden",
      "footer.tagline": "Machen Sie Ihre Produkteinführungen spannender",
      "footer.product": "Produkt",
      "footer.features": "Funktionen",
      "footer.pricing": "Preise",
      "footer.faq": "FAQ",
      "footer.resources": "Ressourcen",
      "footer.docs": "Dokumentation",
      "footer.blog": "Blog",
      "footer.tutorials": "Tutorials",
      "footer.company": "Unternehmen",
      "footer.about": "Über uns",
      "footer.privacy": "Datenschutz",
      "footer.terms": "AGB",
      "footer.imprint": "Impressum",
      "footer.follow": "Folgen Sie uns",
      "footer.copyright": "© 2025 Variant Release Date Scheduler. Alle Rechte vorbehalten."
  },
  en: {
      "nav.features": "Features",
      "nav.pricing": "Pricing",
      "nav.testimonials": "Testimonials",
      "nav.faq": "FAQ",
      "nav.contact": "Contact",
      "hero.title": "Scheduled Product Variants for Your Shopify Store",
      "hero.subtitle": "Plan the release of product variants and create anticipation among your customers.",
      "hero.cta": "Install Now",
      "hero.learn": "Learn More",
      "features.title": "Features",
      "features.subtitle": "Discover how Variant Release Date Scheduler enhances your store",
      "features.feature1.title": "Scheduled Release",
      "features.feature1.desc": "Make product variants available in your store at a specific time and automate product launches.",
      "features.feature2.title": "Preview Before Release",
      "features.feature2.desc": "Variants are already visible in the store but can only be purchased after the set date.",
      "features.feature3.title": "Quick Setup",
      "features.feature3.desc": "Configured in just 5 minutes – no technical knowledge required.",
      "features.feature4.title": "Countdown Timer",
      "features.feature4.desc": "Create excitement with a countdown until the variant is released.",
      "features.feature5.title": "Timezone Support",
      "features.feature5.desc": "Schedule releases based on your customers' local time zones.",
      "features.feature6.title": "Interest Metrics",
      "features.feature6.desc": "Track how many customers are interested in upcoming variants.",
      "pricing.title": "Pricing",
      "pricing.subtitle": "Transparent pricing for all store sizes",
      "pricing.popular": "Popular",
      "pricing.basic.title": "Basic",
      "pricing.basic.period": "/month",
      "pricing.basic.feature1": "Up to 20 scheduled variants",
      "pricing.basic.feature2": "Basic countdown functionality",
      "pricing.basic.feature3": "Email support",
      "pricing.basic.cta": "Get Started",
      "pricing.pro.title": "Pro",
      "pricing.pro.period": "/month",
      "pricing.pro.feature1": "Unlimited scheduled variants",
      "pricing.pro.feature2": "Advanced countdown options",
      "pricing.pro.feature3": "Priority support",
      "pricing.pro.feature4": "Customer interest tracking",
      "pricing.pro.feature5": "Customizable notifications",
      "pricing.pro.cta": "Choose Pro",
      "pricing.business.title": "Business",
      "pricing.business.period": "/month",
      "pricing.business.feature1": "Everything from Pro",
      "pricing.business.feature2": "Multi-store support",
      "pricing.business.feature3": "API access",
      "pricing.business.feature4": "Dedicated account manager",
      "pricing.business.feature5": "Advanced analytics tools",
      "pricing.business.cta": "Choose Business",
      "testimonials.title": "Testimonials",
      "testimonials.subtitle": "What our customers say about Variant Release Date Scheduler",
      "testimonials.testimonial1.text": "\"The app has revolutionized our product launches. We were able to direct our customers' attention to upcoming products and increase sales by 40% on release day.\"",
      "testimonials.testimonial1.name": "Mark Miller",
      "testimonials.testimonial1.company": "Miller Fashion Ltd",
      "testimonials.testimonial2.text": "\"Easy to use and incredibly effective. The preview function for variants has greatly increased anticipation for our limited editions.\"",
      "testimonials.testimonial2.name": "Laura Klein",
      "testimonials.testimonial2.company": "Trendy Treasures",
      "testimonials.testimonial3.text": "\"This app was exactly what we needed for our seasonal collections. Setup was super easy and the support is excellent.\"",
      "testimonials.testimonial3.name": "Thomas Smith",
      "testimonials.testimonial3.company": "Outdoor Life",
      "faq.title": "Frequently Asked Questions",
      "faq.subtitle": "Answers to your questions about Variant Release Date Scheduler",
      "faq.q1": "How does the Variant Release Date Scheduler work?",
      "faq.a1": "The app allows you to set a date and time when product variants will be unlocked for purchase. The variants are displayed in the store but cannot be added to the cart until the specified time.",
      "faq.q2": "Is the installation complicated?",
      "faq.a2": "No, installation and configuration takes only about 5 minutes. After installing from the Shopify App Store, you just need to select the products and set the release times for the variants.",
      "faq.q3": "How are customers informed about new variants?",
      "faq.a3": "The app displays a countdown on the product page. Customers can also sign up for notifications to be informed by email when the variant becomes available.",
      "faq.q4": "Which Shopify themes is the app compatible with?",
      "faq.a4": "Our app is compatible with all current Shopify themes. For older or heavily customized themes, additional customization may be required, for which our support team is available to assist you.",
      "faq.q5": "Is there a free trial?",
      "faq.a5": "Yes, you can try the app for free for 14 days before deciding on a subscription. During the trial period, all features of the Pro package are available to you.",
      "contact.title": "Contact",
      "contact.subtitle": "Have questions? Contact us!",
      "contact.email": "Email",
      "contact.phone": "Phone",
      "contact.hours": "Business Hours",
      "contact.hours_detail": "Mon-Fri: 9:00 AM - 5:00 PM",
      "contact.form.name": "Name",
      "contact.form.email": "Email",
      "contact.form.subject": "Subject",
      "contact.form.message": "Message",
      "contact.form.submit": "Send Message",
      "footer.tagline": "Make your product launches more exciting",
      "footer.product": "Product",
      "footer.features": "Features",
      "footer.pricing": "Pricing",
      "footer.faq": "FAQ",
      "footer.resources": "Resources",
      "footer.docs": "Documentation",
      "footer.blog": "Blog",
      "footer.tutorials": "Tutorials",
      "footer.company": "Company",
      "footer.about": "About Us",
      "footer.privacy": "Privacy Policy",
      "footer.terms": "Terms of Service",
      "footer.imprint": "Imprint",
      "footer.follow": "Follow Us",
      "footer.copyright": "© 2025 Variant Release Date Scheduler. All rights reserved."
  }
};

document.addEventListener('DOMContentLoaded', function() {
  // Initialize language
  const defaultLang = 'de';
  let currentLang = localStorage.getItem('language') || defaultLang;

  // Set initial language
  setLanguage(currentLang);

  // Language switcher
  document.getElementById('lang-de').addEventListener('click', function() {
      setLanguage('de');
  });

  document.getElementById('lang-en').addEventListener('click', function() {
      setLanguage('en');
  });

  // Mobile menu toggle
  const menuToggle = document.querySelector('.mobile-menu-toggle');
  if (menuToggle) {
      menuToggle.addEventListener('click', toggleMobileMenu);
  }

  // FAQ toggle
  const faqItems = document.querySelectorAll('.faq-item');
  faqItems.forEach(item => {
      const question = item.querySelector('.faq-question');
      question.addEventListener('click', () => {
          item.classList.toggle('active');
      });
  });

  // Testimonial slider
  const testimonialSlides = document.querySelectorAll('.testimonial-slide');
  const testimonialDots = document.querySelectorAll('.testimonial-dots .dot');
  const prevButton = document.querySelector('.prev-testimonial');
  const nextButton = document.querySelector('.next-testimonial');

  if (testimonialDots.length > 0) {
      testimonialDots.forEach(dot => {
          dot.addEventListener('click', () => {
              const slideIndex = parseInt(dot.getAttribute('data-slide'));
              showTestimonialSlide(slideIndex);
          });
      });
  }

  if (prevButton) {
      prevButton.addEventListener('click', () => {
          const currentSlide = document.querySelector('.testimonial-slide.active');
          if (!currentSlide) return;

          const slides = document.querySelectorAll('.testimonial-slide');
          let currentIndex = Array.from(slides).indexOf(currentSlide);

          currentIndex = (currentIndex - 1 + slides.length) % slides.length;
          showTestimonialSlide(currentIndex);
      });
  }

  if (nextButton) {
      nextButton.addEventListener('click', () => {
          const currentSlide = document.querySelector('.testimonial-slide.active');
          if (!currentSlide) return;

          const slides = document.querySelectorAll('.testimonial-slide');
          let currentIndex = Array.from(slides).indexOf(currentSlide);

          currentIndex = (currentIndex + 1) % slides.length;
          showTestimonialSlide(currentIndex);
      });
  }

  // Auto-rotate testimonials if they exist
  if (testimonialSlides.length > 0) {
      let testimonialInterval = setInterval(() => {
          const currentSlide = document.querySelector('.testimonial-slide.active');
          if (!currentSlide) return;

          const slides = document.querySelectorAll('.testimonial-slide');
          let currentIndex = Array.from(slides).indexOf(currentSlide);

          currentIndex = (currentIndex + 1) % slides.length;
          showTestimonialSlide(currentIndex);
      }, 5000);

      // Pause auto-rotate on hover
      const testimonialSlider = document.querySelector('.testimonial-slider');
      if (testimonialSlider) {
          testimonialSlider.addEventListener('mouseenter', () => {
              clearInterval(testimonialInterval);
          });

          testimonialSlider.addEventListener('mouseleave', () => {
              testimonialInterval = setInterval(() => {
                  const currentSlide = document.querySelector('.testimonial-slide.active');
                  if (!currentSlide) return;

                  const slides = document.querySelectorAll('.testimonial-slide');
                  let currentIndex = Array.from(slides).indexOf(currentSlide);

                  currentIndex = (currentIndex + 1) % slides.length;
                  showTestimonialSlide(currentIndex);
              }, 5000);
          });
      }
  }

  // Form submission
  const contactForm = document.getElementById('contactForm');
  if (contactForm) {
      contactForm.addEventListener('submit', function(e) {
          e.preventDefault();

          // Get form data
          const formData = new FormData(contactForm);
          const formObject = {};

          formData.forEach((value, key) => {
              formObject[key] = value;
          });

          // Get current language for alert message
          const currentLang = localStorage.getItem('language') || 'de';
          let thankYouMsg = '';

          if (currentLang === 'de') {
              thankYouMsg = `Vielen Dank für Ihre Nachricht!\nWir werden uns so bald wie möglich bei Ihnen unter ${formObject.email} melden.`;
          } else {
              thankYouMsg = `Thank you for your message!\nWe will get back to you at ${formObject.email} as soon as possible.`;
          }

          // Simulate form submission
          alert(thankYouMsg);
          contactForm.reset();
      });
  }

  // Smooth scroll to section when clicking nav links
  const navLinks = document.querySelectorAll('a[href^="#"]');
  navLinks.forEach(link => {
      link.addEventListener('click', function(e) {
          const href = this.getAttribute('href');

          // Only handle links that point to an ID on the current page
          if (href !== '#' && href.startsWith('#')) {
              e.preventDefault();

              const targetId = href;
              const targetElement = document.querySelector(targetId);

              if (targetElement) {
                  // Close mobile menu if open
                  const mobileMenu = document.querySelector('.mobile-menu');
                  if (mobileMenu && mobileMenu.classList.contains('active')) {
                      mobileMenu.classList.remove('active');
                  }

                  // Scroll to element
                  window.scrollTo({
                      top: targetElement.offsetTop - 100,
                      behavior: 'smooth'
                  });
              }
          }
      });
  });
});

// Functions
function setLanguage(lang) {
  document.documentElement.setAttribute('lang', lang);
  localStorage.setItem('language', lang);

  // Update active button
  const deLangBtn = document.getElementById('lang-de');
  const enLangBtn = document.getElementById('lang-en');

  if (deLangBtn && enLangBtn) {
      deLangBtn.classList.toggle('active', lang === 'de');
      enLangBtn.classList.toggle('active', lang === 'en');
  }

  // Update all elements with data-i18n attribute
  const elements = document.querySelectorAll('[data-i18n]');
  elements.forEach(element => {
      const key = element.getAttribute('data-i18n');
      if (translations[lang] && translations[lang][key]) {
          if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
              element.placeholder = translations[lang][key];
          } else {
              element.textContent = translations[lang][key];
          }
      }
  });

  // Handle special content toggles for legal pages
  const termsDE = document.getElementById('terms-de');
  const termsEN = document.getElementById('terms-en');
  const privacyDE = document.getElementById('privacy-de');
  const privacyEN = document.getElementById('privacy-en');
  const imprintDE = document.getElementById('imprint-de');
  const imprintEN = document.getElementById('imprint-en');

  // Terms page
  if (termsDE && termsEN) {
      termsDE.style.display = lang === 'de' ? 'block' : 'none';
      termsEN.style.display = lang === 'en' ? 'block' : 'none';
  }

  // Privacy page
  if (privacyDE && privacyEN) {
      privacyDE.style.display = lang === 'de' ? 'block' : 'none';
      privacyEN.style.display = lang === 'en' ? 'block' : 'none';
  }

  // Imprint page
  if (imprintDE && imprintEN) {
      imprintDE.style.display = lang === 'de' ? 'block' : 'none';
      imprintEN.style.display = lang === 'en' ? 'block' : 'none';
  }
}

function showTestimonialSlide(index) {
  const slides = document.querySelectorAll('.testimonial-slide');
  const dots = document.querySelectorAll('.testimonial-dots .dot');

  if (!slides.length || !dots.length) return;

  // Hide all slides
  slides.forEach(slide => {
      slide.classList.remove('active');
  });

  // Remove active class from all dots
  dots.forEach(dot => {
      dot.classList.remove('active');
  });

  // Show the selected slide
  slides[index].classList.add('active');
  dots[index].classList.add('active');
}

function toggleMobileMenu() {
  const body = document.querySelector('body');

  // Create mobile menu if it doesn't exist
  if (!document.querySelector('.mobile-menu')) {
      const mobileMenu = document.createElement('div');
      mobileMenu.className = 'mobile-menu';

      const menuHeader = document.createElement('div');
      menuHeader.className = 'mobile-menu-header';

      const logoClone = document.querySelector('.logo').cloneNode(true);

      const closeButton = document.createElement('button');
      closeButton.className = 'mobile-menu-close';
      closeButton.innerHTML = '<i class="fas fa-times"></i>';
      closeButton.addEventListener('click', toggleMobileMenu);

      menuHeader.appendChild(logoClone);
      menuHeader.appendChild(closeButton);

      const mobileNav = document.createElement('ul');
      mobileNav.className = 'mobile-nav';

      // Clone nav items
      const navItems = document.querySelectorAll('.main-nav li');
      navItems.forEach(item => {
          const clone = item.cloneNode(true);
          mobileNav.appendChild(clone);
      });

      const menuFooter = document.createElement('div');
      menuFooter.className = 'mobile-menu-footer';

      const langSwitcherClone = document.querySelector('.language-switcher').cloneNode(true);
      menuFooter.appendChild(langSwitcherClone);

      mobileMenu.appendChild(menuHeader);
      mobileMenu.appendChild(mobileNav);
      mobileMenu.appendChild(menuFooter);

      body.appendChild(mobileMenu);

      // Add event listeners to cloned language switcher
      const langDEBtn = langSwitcherClone.querySelector('#lang-de');
      const langENBtn = langSwitcherClone.querySelector('#lang-en');

      if (langDEBtn && langENBtn) {
          langDEBtn.addEventListener('click', function() {
              setLanguage('de');
          });

          langENBtn.addEventListener('click', function() {
              setLanguage('en');
          });
      }

      // Add event listeners to cloned nav links
      const mobileNavLinks = mobileMenu.querySelectorAll('a[href^="#"]');
      mobileNavLinks.forEach(link => {
          link.addEventListener('click', toggleMobileMenu);
      });
  }

  // Toggle mobile menu
  const mobileMenu = document.querySelector('.mobile-menu');
  mobileMenu.classList.toggle('active');

  // Prevent scrolling when menu is open
  body.style.overflow = mobileMenu.classList.contains('active') ? 'hidden' : '';
}
